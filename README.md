# terraform-module-github-repositories

Terraform module for managing Github repositories.

## Content

<!-- tree -a -I .git .` -->

```text
.
├── .github                      # Github configuration directory
│   └── workflows                # Github Actions configuration
│       └── ci.yml               # CI pipeline configuration
├── .gitignore                   # git ignore file
├── .terraform-docs.yml          # terraform-docs configuration
├── .terraform.lock.hcl          # terraform lock file
├── Makefile                     # makefile for ease
├── README.md                    # this file
├── examples                     # terraform module examples of use
│   └── docs                     # terraform module examples of use for documentation
│       └── main.tf              # terraform main.tf file for documentation
├── main.tf                      # terraform module main.tf file
├── outputs.tf                   # terraform module outputs.tf file
└── variables.tf                 # terraform module variables.tf file
```

<!-- **WARNING:** Please don't change the content below this line.  This is automatically generated by [terraform-docs](https://github.com/terraform-docs/terraform-docs) -->

<!-- BEGIN_TF_DOCS -->


## Providers

| Name | Version |
|------|---------|
| github | 5.34.0 |

## Resources

| Name | Type |
|------|------|
| [github_actions_secret.this](https://registry.terraform.io/providers/integrations/github/latest/docs/resources/actions_secret) | resource |
| [github_branch_protection.this](https://registry.terraform.io/providers/integrations/github/latest/docs/resources/branch_protection) | resource |
| [github_repository.this](https://registry.terraform.io/providers/integrations/github/latest/docs/resources/repository) | resource |
| [github_repository_webhook.this](https://registry.terraform.io/providers/integrations/github/latest/docs/resources/repository_webhook) | resource |
| [github_team_repository.this](https://registry.terraform.io/providers/integrations/github/latest/docs/resources/team_repository) | resource |

## Modules

No modules.

## Inputs

| Name | Description | Type | Default | Required |
|------|-------------|------|---------|:--------:|
| account | Account (individual user or organization) where the repositories will be created. | `string` | n/a | yes |
| account\_type | Type of Github account. | `string` | `"user"` | no |
| default\_repository\_config | The default configuration to be applied to all repositories. | `any` | <pre>{<br>  "allow_merge_commit": false,<br>  "allow_rebase_merge": false,<br>  "allow_squash_merge": true,<br>  "auto_init": false,<br>  "branch_protection_rules": [<br>    {<br>      "branch_name_pattern": "main"<br>    }<br>  ],<br>  "delete_branch_on_merge": true,<br>  "has_downloads": false,<br>  "has_issues": false,<br>  "has_projects": false,<br>  "has_wiki": false,<br>  "visibility": "private",<br>  "vulnerability_alerts": true<br>}</pre> | no |
| repositories | List of objects containing the repository definitions. Parameter 'name' is mandatory. | `any` | n/a | yes |

## Outputs

| Name | Description |
|------|-------------|
| http\_clone\_urls | HTTP urls for cloning the repositories. |
| repository\_names | Names of the repositories. |
| ssh\_clone\_urls | SSH urls for cloning the repositories. |

## Requirements

| Name | Version |
|------|---------|
| terraform | ~> 1.0 |
| github | ~> 5.34 |

## Development

- This project uses [Semantic Versioning](https://semver.org/).

## Examples

```hcl
module "github_repo" {
  source = "../../"

  account = "myOrg"
  default_repository_config = {
    allow_merge_commit     = false
    allow_rebase_merge     = false
    allow_squash_merge     = true
    auto_init              = false
    delete_branch_on_merge = true
    has_downloads          = false
    has_issues             = false
    has_projects           = false
    has_wiki               = false
    visibility             = "private"
    vulnerability_alerts   = true
    branch_protection_rules = [
      {
        branch_name_pattern = "main"
      }
    ]
    webhooks = [
      {
        active = true
        events = ["push", "pull_request"]
        url    = "https://ci-1.contoso.com"
      }
    ]
  }
  repositories = [
    {
      name                 = "foo"
      description          = "Repo for the foo project."
      vulnerability_alerts = false
      access = {
        "team1" = "admin"
        "user1" = "pull"
      },
      branch_protection_rules = [
        {
          branch_name_pattern = "master"
          allow_force_pushes  = true
        }
      ]

      actions_repository_secrets = [
        {
          secret_name     = "TOKEN"
          encrypted_value = var.secret_token_value
        }
      ]
      }, {
      name        = "bar"
      description = "Repo for the bar project."
      access = {
        "team1" = "pull"
        "user1" = "admin"
      }
      branch_protection_rules = [
        {
          branch_name_pattern = "main"
          required_pull_request_reviews = {
            required_approving_review_count = 2
          }
        }
      ]
      webhooks = [
        {
          active       = true
          events       = ["pull_request"]
          insecure_ssl = true
          url          = "https://ci-2.contoso.com"
        },
        {
          active       = false
          events       = ["issues"]
          insecure_ssl = true
          url          = "https://ci-3.contoso.com"
        }
      ]
    }
  ]
}
```
<!-- END_TF_DOCS -->
